name: Mark Stale Issues and PRs

on:
  schedule:
    - cron: '0 1 * * *'  # Daily at 1 AM UTC
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/stale@v8
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          
          # Days before an issue becomes stale
          days-before-stale: 60
          
          # Days before a stale issue is closed
          days-before-close: 30
          
          # Days before a PR becomes stale
          days-before-pr-stale: 30
          
          # Days before a stale PR is closed
          days-before-pr-close: 14
          
          # Label to apply to stale issues
          stale-issue-label: 'stale'
          
          # Label to apply to stale PRs
          stale-pr-label: 'stale'
          
          # Comment to post when marking an issue as stale
          stale-issue-message: |
            This issue has been automatically marked as stale because it has not had
            recent activity. It will be closed if no further activity occurs within
            the next 30 days. If this issue is still relevant, please comment to
            keep it open.
            
            Thank you for your contributions!
          
          # Comment to post when marking a PR as stale
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has
            not had recent activity. It will be closed if no further activity occurs
            within the next 14 days. If this PR is still relevant, please comment or
            push new commits to keep it open.
            
            Thank you for your contributions!
          
          # Comment to post when closing a stale issue
          close-issue-message: |
            This issue has been automatically closed due to inactivity. If you
            believe this issue is still relevant, please reopen it or create a
            new issue with updated information.
          
          # Comment to post when closing a stale PR
          close-pr-message: |
            This pull request has been automatically closed due to inactivity.
            If you would like to continue this work, please reopen the PR or
            create a new one.
          
          # Labels that prevent an issue from being marked as stale
          exempt-issue-labels: 'pinned,security,critical,in-progress,backlog'
          
          # Labels that prevent a PR from being marked as stale
          exempt-pr-labels: 'pinned,security,critical,in-progress,wip'
          
          # Only process issues/PRs with these labels (empty = all)
          only-labels: ''
          
          # Skip issues/PRs with any of these labels
          exempt-all-issue-assignees: true
          exempt-all-pr-assignees: true
          
          # Enable debug output
          debug-only: false
          
          # Max number of operations per run
          operations-per-run: 100
          
          # Remove stale label when issue/PR is updated
          remove-stale-when-updated: true
          
          # Process issues and PRs
          include-only-assigned: false